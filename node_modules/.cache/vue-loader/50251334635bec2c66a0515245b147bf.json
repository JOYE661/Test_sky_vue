{"remainingRequest":"/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/app/src/views/category/index.vue?vue&type=script&lang=ts","dependencies":[{"path":"/app/src/views/category/index.vue","mtime":1692717650000},{"path":"/app/node_modules/babel-loader/lib/index.js","mtime":1767081204095},{"path":"/app/node_modules/ts-loader/index.js","mtime":1767081197570},{"path":"/app/node_modules/cache-loader/dist/cjs.js","mtime":1767081203604},{"path":"/app/node_modules/vue-loader/lib/index.js","mtime":1767081197097}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue } from 'vue-property-decorator'\nimport HeadLable from '@/components/HeadLable/index.vue'\nimport {\n  getCategoryPage,\n  deleCategory,\n  editCategory,\n  addCategory,\n  enableOrDisableEmployee\n} from '@/api/category'\nimport Empty from '@/components/Empty/index.vue'\n\n@Component({\n  name: 'Category',\n  components: {\n    HeadLable,\n    Empty\n  }\n})\nexport default class extends Vue {\n  private options: any = [\n    {\n      value: 1,\n      label: '菜品分类'\n    },\n    {\n      value: 2,\n      label: '套餐分类'\n    }\n  ]\n  private actionType: string = ''\n  private id = ''\n  private status = ''\n  private categoryType: number = null\n  private name: string = ''\n  private action: string = ''\n  private counts: number = 0\n  private page: number = 1\n  private pageSize: number = 10\n  private tableData = []\n  private type = ''\n  private isSearch: boolean = false\n  private classData: any = {\n    title: '添加菜品分类',\n    dialogVisible: false,\n    categoryId: '',\n    name: '',\n    sort: ''\n  }\n\n  get rules() {\n    return {\n      name: [\n        {\n          required: true,\n          trigger: 'blur',\n          validator: (rule: any, value: string, callback: Function) => {\n            // const reg = /[\\u4e00-\\u9fa5]/\n            var reg = new RegExp('^[A-Za-z\\u4e00-\\u9fa5]+$')\n            if (!value) {\n              callback(new Error(this.classData.title + '不能为空'))\n            } else if (value.length < 2) {\n              callback(new Error('分类名称输入不符，请输入2-20个字符'))\n            } else if (!reg.test(value)) {\n              callback(new Error('分类名称包含特殊字符'))\n            } else {\n              callback()\n            }\n          }\n        }\n      ],\n      sort: [\n        {\n          required: true,\n          trigger: 'blur',\n          validator: (rule: any, value: string, callback: Function) => {\n            if (value || String(value) === '0') {\n              const reg = /^\\d+$/\n              if (!reg.test(value)) {\n                callback(new Error('排序只能输入数字类型'))\n              } else if (Number(value) > 99) {\n                callback(new Error('排序只能输入0-99数字'))\n              } else {\n                callback()\n              }\n            } else {\n              callback(new Error('排序不能为空'))\n            }\n          }\n        }\n      ]\n    }\n  }\n\n  created() {\n    this.init()\n  }\n\n  // 初始化信息\n  private async init(isSearch?) {\n    this.isSearch = isSearch\n    await getCategoryPage({\n      page: this.page,\n      pageSize: this.pageSize,\n      name: this.name ? this.name : undefined,\n      type: this.categoryType ? this.categoryType : undefined\n    })\n      .then(res => {\n        if (String(res.data.code) === '1') {\n          this.tableData =\n            res && res.data && res.data.data && res.data.data.records\n          this.counts = Number(res.data.data.total)\n        } else {\n          this.$message.error(res.data.desc)\n        }\n      })\n      .catch(err => {\n        console.log(err, 'err')\n        this.$message.error('请求出错了：' + err.message)\n      })\n  }\n\n  // 添加\n  private addClass(st: any) {\n    if (st == 'class') {\n      this.classData.title = '新增菜品分类'\n      this.type = '1'\n    } else {\n      this.classData.title = '新增套餐分类'\n      this.type = '2'\n    }\n    this.action = 'add'\n    this.classData.name = ''\n    this.classData.sort = ''\n    this.classData.dialogVisible = true\n    this.actionType = 'add'\n  }\n\n  // 修改\n  private editHandle(dat: any) {\n    this.classData.title = '修改分类'\n    this.action = 'edit'\n    this.classData.name = dat.name\n    this.classData.sort = dat.sort\n    this.classData.id = dat.id\n    this.classData.dialogVisible = true\n    this.actionType = 'edit'\n  }\n\n  // 关闭弹窗\n  private handleClose(st: string) {\n    console.log(this.$refs.classData, 'this.$refs.classData')\n    this.classData.dialogVisible = false\n    //对该表单项进行重置，将其值重置为初始值并移除校验结果\n    this.$refs.classData.resetFields()\n  }\n\n  //状态修改\n  private statusHandle(row: any) {\n    this.id = row.id\n    this.status = row.status\n    this.$confirm('确认调整该分类的状态?', '提示', {\n      confirmButtonText: '确定',\n      cancelButtonText: '取消',\n      type: 'warning',\n      customClass: 'customClass'\n    }).then(() => {\n      enableOrDisableEmployee({ id: this.id, status: !this.status ? 1 : 0 })\n        .then(res => {\n          if (String(res.status) === '200') {\n            this.$message.success('分类状态更改成功！')\n            this.init()\n          }\n        })\n        .catch(err => {\n          this.$message.error('请求出错了：' + err.message)\n        })\n    })\n  }\n\n  //删除\n  private deleteHandle(id: any) {\n    this.$confirm('此操作将永久删除该分类，是否继续？', '确定删除', {\n      confirmButtonText: '删除',\n      cancelButtonText: '取消',\n      type: 'warning'\n    }).then(() => {\n      deleCategory(id)\n        .then(res => {\n          if (res.data.code === 1) {\n            this.$message.success('删除成功！')\n            this.init()\n          } else {\n            this.$message.error(res.data.msg)\n          }\n        })\n        .catch(err => {\n          this.$message.error('请求出错了：' + err.message)\n        })\n    })\n  }\n\n  $refs!: {\n    classData: any\n  }\n\n  //数据提交\n  submitForm(st: any) {\n    if (this.action === 'add') {\n      this.$refs.classData.validate((value: boolean) => {\n        if (value) {\n          addCategory({\n            name: this.classData.name,\n            type: this.type,\n            sort: this.classData.sort\n          })\n            .then(res => {\n              if (res.data.code === 1) {\n                this.$message.success('分类添加成功！')\n                this.$refs.classData.resetFields()\n                if (!st) {\n                  this.classData.dialogVisible = false\n                }\n                this.init()\n              } else {\n                this.$message.error(res.data.desc || res.data.msg)\n              }\n            })\n            .catch(err => {\n              this.$message.error('请求出错了：' + err.message)\n            })\n        }\n      })\n    } else {\n      this.$refs.classData.validate((value: boolean) => {\n        if (value) {\n          editCategory({\n            id: this.classData.id,\n            name: this.classData.name,\n            sort: this.classData.sort\n          })\n            .then(res => {\n              if (res.data.code === 1) {\n                this.$message.success('分类修改成功！')\n                this.classData.dialogVisible = false\n                this.$refs.classData.resetFields()\n                this.init()\n              } else {\n                this.$message.error(res.data.desc || res.data.msg)\n              }\n            })\n            .catch(err => {\n              this.$message.error('请求出错了：' + err.message)\n            })\n        }\n      })\n    }\n  }\n\n  //分页\n  private handleSizeChange(val: any) {\n    this.pageSize = val\n    this.init()\n  }\n\n  private handleCurrentChange(val: any) {\n    this.page = val\n    this.init()\n  }\n}\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/category","sourcesContent":["<template>\n  <div class=\"dashboard-container\">\n    <div class=\"container\">\n      <div class=\"tableBar\"\n           style=\"display: inline-block; width: 100%\">\n        <label style=\"margin-right: 10px\">分类名称：</label>\n        <el-input v-model=\"name\"\n                  placeholder=\"请填写分类名称\"\n                  style=\"width: 15%\"\n                  clearable\n                  @clear=\"init\"\n                  @keyup.enter.native=\"init\" />\n\n        <label style=\"margin-right: 5px; margin-left: 20px\">分类类型：</label>\n        <el-select v-model=\"categoryType\"\n                   placeholder=\"请选择\"\n                   clearable\n                   style=\"width: 15%\"\n                   @clear=\"init\">\n          <el-option v-for=\"item in options\"\n                     :key=\"item.value\"\n                     :label=\"item.label\"\n                     :value=\"item.value\" />\n        </el-select>\n\n        <div style=\"float: right\">\n          <el-button type=\"primary\"\n                     class=\"continue\"\n                     @click=\"addClass('class')\">\n            + 新增菜品分类\n          </el-button>\n          <el-button type=\"primary\"\n                     style=\"margin-left:20px\"\n                     @click=\"addClass('meal')\">\n            + 新增套餐分类\n          </el-button>\n        </div>\n\n        <el-button class=\"normal-btn continue\"\n                   @click=\"init(true)\">\n          查询\n        </el-button>\n      </div>\n      <el-table v-if=\"tableData.length\"\n                :data=\"tableData\"\n                stripe\n                class=\"tableBox\">\n        <el-table-column prop=\"name\"\n                         label=\"分类名称\" />\n        <el-table-column prop=\"type\"\n                         label=\"分类类型\">\n          <template slot-scope=\"scope\">\n            <span>{{ scope.row.type == '1' ? '菜品分类' : '套餐分类' }}</span>\n          </template>\n        </el-table-column>\n\n        <el-table-column prop=\"sort\"\n                         label=\"排序\" />\n        <el-table-column label=\"状态\">\n          <template slot-scope=\"scope\">\n            <div class=\"tableColumn-status\"\n                 :class=\"{ 'stop-use': String(scope.row.status) === '0' }\">\n              {{ String(scope.row.status) === '0' ? '禁用' : '启用' }}\n            </div>\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"updateTime\"\n                         label=\"操作时间\" />\n        <el-table-column label=\"操作\"\n                         width=\"200\"\n                         align=\"center\">\n          <template slot-scope=\"scope\">\n            <el-button type=\"text\"\n                       size=\"small\"\n                       class=\"blueBug\"\n                       @click=\"editHandle(scope.row)\">\n              修改\n            </el-button>\n            <el-button type=\"text\"\n                       size=\"small\"\n                       class=\"delBut\"\n                       @click=\"deleteHandle(scope.row.id)\">\n              删除\n            </el-button>\n            <el-button type=\"text\"\n                       size=\"small\"\n                       class=\"non\"\n                       :class=\"{\n                         blueBug: scope.row.status == '0',\n                         delBut: scope.row.status != '0'\n                       }\"\n                       @click=\"statusHandle(scope.row)\">\n              {{ scope.row.status == '1' ? '禁用' : '启用' }}\n            </el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n      <Empty v-else\n             :is-search=\"isSearch\" />\n      <el-pagination v-if=\"counts > 10\"\n                     class=\"pageList\"\n                     :page-sizes=\"[10, 20, 30, 40]\"\n                     :page-size=\"pageSize\"\n                     layout=\"total, sizes, prev, pager, next, jumper\"\n                     :total=\"counts\"\n                     @size-change=\"handleSizeChange\"\n                     @current-change=\"handleCurrentChange\" />\n    </div>\n    <el-dialog :title=\"classData.title\"\n               :visible.sync=\"classData.dialogVisible\"\n               width=\"30%\"\n               :before-close=\"handleClose\">\n      <el-form ref=\"classData\"\n               :model=\"classData\"\n               class=\"demo-form-inline\"\n               :rules=\"rules\"\n               label-width=\"100px\">\n        <el-form-item label=\"分类名称：\"\n                      prop=\"name\">\n          <el-input v-model=\"classData.name\"\n                    placeholder=\"请输入分类名称\"\n                    maxlength=\"20\" />\n        </el-form-item>\n        <el-form-item label=\"排序：\"\n                      prop=\"sort\">\n          <el-input v-model=\"classData.sort\"\n                    placeholder=\"请输入排序\" />\n        </el-form-item>\n      </el-form>\n      <span slot=\"footer\"\n            class=\"dialog-footer\">\n        <el-button size=\"medium\"\n                   @click=\"\n            ;(classData.dialogVisible = false), $refs.classData.resetFields()\n                   \">取 消</el-button>\n        <el-button type=\"primary\"\n                   :class=\"{ continue: actionType === 'add' }\"\n                   size=\"medium\"\n                   @click=\"submitForm()\">确 定</el-button>\n        <el-button v-if=\"action != 'edit'\"\n                   type=\"primary\"\n                   size=\"medium\"\n                   @click=\"submitForm('go')\">\n          保存并继续添加\n        </el-button>\n      </span>\n    </el-dialog>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { Component, Vue } from 'vue-property-decorator'\nimport HeadLable from '@/components/HeadLable/index.vue'\nimport {\n  getCategoryPage,\n  deleCategory,\n  editCategory,\n  addCategory,\n  enableOrDisableEmployee\n} from '@/api/category'\nimport Empty from '@/components/Empty/index.vue'\n\n@Component({\n  name: 'Category',\n  components: {\n    HeadLable,\n    Empty\n  }\n})\nexport default class extends Vue {\n  private options: any = [\n    {\n      value: 1,\n      label: '菜品分类'\n    },\n    {\n      value: 2,\n      label: '套餐分类'\n    }\n  ]\n  private actionType: string = ''\n  private id = ''\n  private status = ''\n  private categoryType: number = null\n  private name: string = ''\n  private action: string = ''\n  private counts: number = 0\n  private page: number = 1\n  private pageSize: number = 10\n  private tableData = []\n  private type = ''\n  private isSearch: boolean = false\n  private classData: any = {\n    title: '添加菜品分类',\n    dialogVisible: false,\n    categoryId: '',\n    name: '',\n    sort: ''\n  }\n\n  get rules() {\n    return {\n      name: [\n        {\n          required: true,\n          trigger: 'blur',\n          validator: (rule: any, value: string, callback: Function) => {\n            // const reg = /[\\u4e00-\\u9fa5]/\n            var reg = new RegExp('^[A-Za-z\\u4e00-\\u9fa5]+$')\n            if (!value) {\n              callback(new Error(this.classData.title + '不能为空'))\n            } else if (value.length < 2) {\n              callback(new Error('分类名称输入不符，请输入2-20个字符'))\n            } else if (!reg.test(value)) {\n              callback(new Error('分类名称包含特殊字符'))\n            } else {\n              callback()\n            }\n          }\n        }\n      ],\n      sort: [\n        {\n          required: true,\n          trigger: 'blur',\n          validator: (rule: any, value: string, callback: Function) => {\n            if (value || String(value) === '0') {\n              const reg = /^\\d+$/\n              if (!reg.test(value)) {\n                callback(new Error('排序只能输入数字类型'))\n              } else if (Number(value) > 99) {\n                callback(new Error('排序只能输入0-99数字'))\n              } else {\n                callback()\n              }\n            } else {\n              callback(new Error('排序不能为空'))\n            }\n          }\n        }\n      ]\n    }\n  }\n\n  created() {\n    this.init()\n  }\n\n  // 初始化信息\n  private async init(isSearch?) {\n    this.isSearch = isSearch\n    await getCategoryPage({\n      page: this.page,\n      pageSize: this.pageSize,\n      name: this.name ? this.name : undefined,\n      type: this.categoryType ? this.categoryType : undefined\n    })\n      .then(res => {\n        if (String(res.data.code) === '1') {\n          this.tableData =\n            res && res.data && res.data.data && res.data.data.records\n          this.counts = Number(res.data.data.total)\n        } else {\n          this.$message.error(res.data.desc)\n        }\n      })\n      .catch(err => {\n        console.log(err, 'err')\n        this.$message.error('请求出错了：' + err.message)\n      })\n  }\n\n  // 添加\n  private addClass(st: any) {\n    if (st == 'class') {\n      this.classData.title = '新增菜品分类'\n      this.type = '1'\n    } else {\n      this.classData.title = '新增套餐分类'\n      this.type = '2'\n    }\n    this.action = 'add'\n    this.classData.name = ''\n    this.classData.sort = ''\n    this.classData.dialogVisible = true\n    this.actionType = 'add'\n  }\n\n  // 修改\n  private editHandle(dat: any) {\n    this.classData.title = '修改分类'\n    this.action = 'edit'\n    this.classData.name = dat.name\n    this.classData.sort = dat.sort\n    this.classData.id = dat.id\n    this.classData.dialogVisible = true\n    this.actionType = 'edit'\n  }\n\n  // 关闭弹窗\n  private handleClose(st: string) {\n    console.log(this.$refs.classData, 'this.$refs.classData')\n    this.classData.dialogVisible = false\n    //对该表单项进行重置，将其值重置为初始值并移除校验结果\n    this.$refs.classData.resetFields()\n  }\n\n  //状态修改\n  private statusHandle(row: any) {\n    this.id = row.id\n    this.status = row.status\n    this.$confirm('确认调整该分类的状态?', '提示', {\n      confirmButtonText: '确定',\n      cancelButtonText: '取消',\n      type: 'warning',\n      customClass: 'customClass'\n    }).then(() => {\n      enableOrDisableEmployee({ id: this.id, status: !this.status ? 1 : 0 })\n        .then(res => {\n          if (String(res.status) === '200') {\n            this.$message.success('分类状态更改成功！')\n            this.init()\n          }\n        })\n        .catch(err => {\n          this.$message.error('请求出错了：' + err.message)\n        })\n    })\n  }\n\n  //删除\n  private deleteHandle(id: any) {\n    this.$confirm('此操作将永久删除该分类，是否继续？', '确定删除', {\n      confirmButtonText: '删除',\n      cancelButtonText: '取消',\n      type: 'warning'\n    }).then(() => {\n      deleCategory(id)\n        .then(res => {\n          if (res.data.code === 1) {\n            this.$message.success('删除成功！')\n            this.init()\n          } else {\n            this.$message.error(res.data.msg)\n          }\n        })\n        .catch(err => {\n          this.$message.error('请求出错了：' + err.message)\n        })\n    })\n  }\n\n  $refs!: {\n    classData: any\n  }\n\n  //数据提交\n  submitForm(st: any) {\n    if (this.action === 'add') {\n      this.$refs.classData.validate((value: boolean) => {\n        if (value) {\n          addCategory({\n            name: this.classData.name,\n            type: this.type,\n            sort: this.classData.sort\n          })\n            .then(res => {\n              if (res.data.code === 1) {\n                this.$message.success('分类添加成功！')\n                this.$refs.classData.resetFields()\n                if (!st) {\n                  this.classData.dialogVisible = false\n                }\n                this.init()\n              } else {\n                this.$message.error(res.data.desc || res.data.msg)\n              }\n            })\n            .catch(err => {\n              this.$message.error('请求出错了：' + err.message)\n            })\n        }\n      })\n    } else {\n      this.$refs.classData.validate((value: boolean) => {\n        if (value) {\n          editCategory({\n            id: this.classData.id,\n            name: this.classData.name,\n            sort: this.classData.sort\n          })\n            .then(res => {\n              if (res.data.code === 1) {\n                this.$message.success('分类修改成功！')\n                this.classData.dialogVisible = false\n                this.$refs.classData.resetFields()\n                this.init()\n              } else {\n                this.$message.error(res.data.desc || res.data.msg)\n              }\n            })\n            .catch(err => {\n              this.$message.error('请求出错了：' + err.message)\n            })\n        }\n      })\n    }\n  }\n\n  //分页\n  private handleSizeChange(val: any) {\n    this.pageSize = val\n    this.init()\n  }\n\n  private handleCurrentChange(val: any) {\n    this.page = val\n    this.init()\n  }\n}\n</script>\n<style lang=\"scss\" scoped>\n.dashboard {\n  &-container {\n    margin: 30px;\n\n    .container {\n      background: #fff;\n      position: relative;\n      z-index: 1;\n      padding: 30px 28px;\n      border-radius: 4px;\n\n      .tableBar {\n        display: flex;\n        margin-bottom: 20px;\n        justify-content: space-between;\n      }\n\n      .tableBox {\n        width: 100%;\n        border: 1px solid $gray-5;\n        border-bottom: 0;\n      }\n\n      .pageList {\n        text-align: center;\n        margin-top: 30px;\n      }\n      //查询黑色按钮样式\n      .normal-btn {\n        background: #333333;\n        color: white;\n        margin-left: 20px;\n      }\n    }\n  }\n}\n</style>\n<style lang='scss'>\n// .customClass {\n//   .el-button--primary {\n//     background-color: #ffc200 !important ;\n//   }\n// }\n</style>\n"]}]}